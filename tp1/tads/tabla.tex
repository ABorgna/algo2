\pagebreak
\section{TAD \tadNombre{Tabla}}

\begin{tad}{\tadNombre{Tabla}}
\tadIgualdadObservacional{t}{t'}{tabla}{
    tRegistros(t) $\igobs$ tRegistros(t') $\land$ \\
    tModificaciones(t) $\igobs$ tModificaciones(t') $\land$ \\
    tCampos(t) $\igobs$ tCampos(t') $\land_L$ \\
    (\paratodo{campo}{c}, c $\in$ tCampos(t)) \\
    \hspace*{2em} tEsClave(t, c) $\igobs$ tEsClave(t', c)
 }

\tadGeneros{tabla}
\tadExporta{tabla, generadores, observadores, otras operaciones}
\tadUsa{\tadNombre{Conjunto($\alpha$)}, \tadNombre{Campo},
    \tadNombre{Registro}, \tadNombre{Valor}}

\tadObservadores
\tadOperacion{tCampos}{tabla}{conj(campo)}{}
\tadOperacion{tEsClave}{tabla/t, campo/c}{bool}{c $\in$ tCampos(t)}
\tadOperacion{tRegistros}{tabla/t}{conj(registro)}{}
\tadOperacion{tModificaciones}{tabla/t}{nat}{}

\tadGeneradores
\tadOperacion{nuevaTabla}{conj(campo)/campos, conj(campo)/claves}{tabla}
    {$\neg\emptyset$?(claves) $\land$ (claves $\subseteq$ campos)}
\tadOperacion{insertarEnTabla}{tabla/t, registro/r}{tabla}
    {tCampos(t) $\subseteq$ rCampos(r) $\land$ $\neg$tRegistroRepetido?(t, r)}
\tadOperacion{borrarDeTabla}{tabla/t, campo/c, valor/v}{tabla}
    {c $\in$ tCampos(t) $\land$ (cEsString?(c) $\iff$ vEsString?(v))}

\tadOtrasOperaciones
\tadOperacion{tieneCampo?}{tabla/t, campo/c}{bool}{}
%\tadOperacion{unaClave}{tabla/t}{campo}{}
\tadOperacion{tRegistroRepetido?}{tabla/t, registro/r}{bool}{tCampos(t) $\subseteq$ rCampos(r)}
\tadOperacion{tClaves}{tabla/t}{conj(campo)}{}
\tadOperacion{dameRegistro}{tabla/t, campo/c, valor/v}{registro}{c $\in$ tClaves(t)}


\tadAxiomas[\paratodo{tabla}{t}]

\tadAxioma{tCampos(nuevaTabla(campos, claves))}{campos}
\tadAxioma{tCampos(insertarEnTabla(t, r))}{tCampos(t)}
\tadAxioma{tCampos(borrarDeTabla(t, c, v))}{tCampos(t)}

\tadAxioma{tEsClave(nuevaTabla(campos, claves), c)}{c $\in$ claves}
\tadAxioma{tEsClave(insertarEnTabla(t, r), c)}{tEsClave(t, c)}
\tadAxioma{tEsClave(borrarDeTabla(t, c, v), c)}{tEsClave(t, c)}

\tadAxioma{tRegistros(nuevaTabla(campos, claves))}{$\emptyset$}
\tadAxioma{tRegistros(insertarEnTabla(t, r))}{Ag(r, tRegistros(t))}
\tadAxioma{tRegistros(borrarDeTabla(t, c, v))}{quitarRegistros(tRegistros(t), c, v)}

\tadAxioma{tModificaciones(nuevaTabla(campos, claves))}{0}
\tadAxioma{tModificaciones(insertarEnTabla(t, r))}{1 + tModificaciones(t)}
\tadAxioma{tModificaciones(borrarDeTabla(t, c, v))}{1 + tModificaciones(t)}

\tadAxioma{tieneCampo?(t, c)}{c $\in$ tCampos(t)}

\tadAxioma{tRegistroRepetido?(t, r)}{
    \IF rVacio?(r) THEN
        false
    ELSE {
        (tiemeCampo?(t, unCampo(r)) $\yluego$ tEsClave(t, unCampo(r)) \\
        $\yluego$ ($\#$quitarRegistros(tRegistos(t), unCampo(r), unValor(r)) \\ 
        \hspace*{2em} $\neq$ $\#$tRegistos(t)) \\
        ) \\%
        $\lor$ tRegistroRepetido?(t, sinUno(r)) %
    } FI %
}

\tadAxioma{tClaves(nuevaTabla(campos, claves))}{claves}
\tadAxioma{tClaves(insertarEnTabla(t, r))}{tClaves(t)}
\tadAxioma{tClaves(borrarDeTabla(t, c, v))}{tClaves(t)}

\tadAxioma{dameRegistro(t, c, v)}{dameRegistrosAux(t, c, v, tRegistros(t))}
\tadAxioma{dameRegistroAux(t, c, v, tRegs)}{
\IF $\varnothing$?(tRegs) THEN 
    nuevoRegistro 
ELSE
    {\IF rValor(dameUno(tRegs), c) == v THEN
        dameUno(tRegs) 
    ELSE 
        dameRegistroAux(t, c , v, sinUno(tRegs)) 
    FI}
FI}


%\tadAxioma{unaClave(t) $\in$ tCampos(t) $\yluego$ esClave(t, unaClave(t))}{true}


\end{tad}

